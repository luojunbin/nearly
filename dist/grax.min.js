!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):"object"==typeof exports?exports.Grax=e(require("react")):t.Grax=e(t.React)}(this,function(t){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){t.exports=r(6)},function(t,e,r){"use strict";function n(t){for(var e in t)a.hasOwnProperty(e)&&(a[e]=t[e])}Object.defineProperty(e,"__esModule",{value:!0}),e.config=void 0;var o=function(){function t(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e.configure=n;var i=r(2),a=e.config={defaultPure:!1,beforeConnect:function(t){},beforeDispatch:function(t){var e=t.split("."),r=o(e,2),n=r[0],a=r[1],u=(0,i.getStore)(n);if(!u)throw Error("store '"+n+"' does not exist");var s=u.dispatchers[a];if(!s)throw Error("the module does not export function "+a);return{store:u,dispatcher:s}}}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){return f[t]?f[t]:f[t]=new c.default(t,e)}function i(t){0===f[t].renders.length&&(f[t]=void 0)}function a(t){return f[t]}function u(){for(var t in f)f[t].state=null}Object.defineProperty(e,"__esModule",{value:!0}),e.registerStore=o,e.unregisterStore=i,e.getStore=a,e.resetStore=u;var s=r(7),c=n(s),f=window.ss={}},function(t,e){"use strict";function r(t){return!!t&&"function"==typeof t.then}function n(t){return t.name||t.displayName||"Component"}Object.defineProperty(e,"__esModule",{value:!0}),e.isThenable=r,e.getComponentName=n},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.config.defaultPure;h.config.beforeConnect(t);var u=function(u){function l(e){o(this,l);var r=i(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,e));return r.state={},r._isDirtyFromGrax=!1,r.store=[].concat(t).map(function(t){return(0,d.getStore)(t)}),r.setState=r.setState.bind(r),r}return a(l,u),c(l,[{key:"setState",value:function(t){var e=this;this._isDirtyFromGrax=!0,f(l.prototype.__proto__||Object.getPrototypeOf(l.prototype),"setState",this).call(this,t,function(){return e._isDirtyFromGrax=!1})}},{key:"initStore",value:function(){return this.store.map(function(t){return t.initState()})}},{key:"componentWillMount",value:function(){var t=this;this.store.forEach(function(e){e.link(t.setState),e.state?t.state[e.storeName]=e.getState():e.initState()})}},{key:"shouldComponentUpdate",value:function(){return!n||this._isDirtyFromGrax}},{key:"componentWillUnmount",value:function(){var t=this;this.store.forEach(function(e){return e.unlink(t)})}},{key:"render",value:function(){return Object.keys(this.state).length!==this.store.length&&void 0!==r?r&&p.default.createElement(r):p.default.createElement(e,s({},this.props,{_storeNames:t,store:s({},this.props.store,this.state)}))}}]),l}(p.default.Component);return u.displayName=(0,y.getComponentName)(e)+"-"+t,u.isGraxComponent=!0,u}Object.defineProperty(e,"__esModule",{value:!0});var s=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},c=function(){function t(t,e){for(var r=0;e.length>r;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),f=function t(e,r,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,r);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(n)};e.connect=u;var l=r(8),p=n(l),h=r(1),d=r(2),y=r(3)},function(t,e,r){"use strict";function n(t){for(var e=i.config.beforeDispatch(t),r=e.store,n=e.dispatcher,o=arguments.length,a=Array(o>1?o-1:0),u=1;o>u;u++)a[u-1]=arguments[u];var s=n.apply(r,[r.getState].concat(a));return r.dispatch(s)}function o(){for(var t=arguments.length,e=Array(t),r=0;t>r;r++)e[r]=arguments[r];return n.bind.apply(n,[null].concat(e))}Object.defineProperty(e,"__esModule",{value:!0}),e.dispatch=n,e.dispatcher=o;var i=r(1)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(4);Object.defineProperty(e,"connect",{enumerable:!0,get:function(){return n.connect}});var o=r(2);Object.defineProperty(e,"getStore",{enumerable:!0,get:function(){return o.getStore}}),Object.defineProperty(e,"registerStore",{enumerable:!0,get:function(){return o.registerStore}}),Object.defineProperty(e,"resetStore",{enumerable:!0,get:function(){return o.resetStore}});var i=r(5);Object.defineProperty(e,"dispatch",{enumerable:!0,get:function(){return i.dispatch}}),Object.defineProperty(e,"dispatcher",{enumerable:!0,get:function(){return i.dispatcher}});var a=r(1);Object.defineProperty(e,"configure",{enumerable:!0,get:function(){return a.configure}})},function(t,e,r){"use strict";function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},a=function(){function t(t,e){for(var r=0;e.length>r;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=r(3),s=function(){function t(e,r){o(this,t),this.storeName=e,this.state=null,this.isPending=!1,this.renderHandlers=[],this.dispatchers=r,this.getState=this.getState.bind(this),this.dispatch=this.dispatch.bind(this),this.syncDispatch=this.syncDispatch.bind(this)}return a(t,[{key:"getState",value:function(){return i({},this.state)}},{key:"initState",value:function(){var t=this;if("function"!=typeof this.dispatchers.init)throw Error("can not find 'init' of store: "+this.storeName);if(this.isPending)return null;var e=this.dispatchers.init(this.getState);return(0,u.isThenable)(e)?(this.isPending=!0,e.then(function(e){t.isPending=!1,t.syncDispatch(e)})):this.syncDispatch(e)}},{key:"link",value:function(t){this.renderHandlers.push(t)}},{key:"unlink",value:function(t){this.renderHandlers=this.renderHandlers.filter(function(e){return e!==t})}},{key:"dispatch",value:function(t){return Promise.resolve(t).then(this.syncDispatch)}},{key:"syncDispatch",value:function(t){var e=this;return null!==t&&(this.state=i({},this.state,t),this.renderHandlers.forEach(function(t){return t(n({},e.storeName,e.getState()))})),this.state}}]),t}();e.default=s},function(e,r){e.exports=t}])});